<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cadastrar Planta</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>Sistema de Cadastro Botânico</h1>
  </header>
  
  <nav>
    <ul>
      <li><a href="index.html">Início</a></li>
      <li><a href="cadastro.html">Cadastrar Planta</a></li>
      <li><a href="gerenciamento.html">Gerenciar Plantas</a></li>
    </ul>
  </nav>
  
  <main>
    <section>
      <h2>Cadastrar Nova Planta</h2>
      <form id="formCadastro">
        <div class="form-group">
          <label for="nome">Nome da Planta (somente letras):</label>
          <input type="text" id="nome" name="nome" required pattern="^[A-Za-zÀ-ú\s]+$">
        </div>
        
        <div class="form-group">
          <label for="especie">Espécie:</label>
          <input type="text" id="especie" name="especie" required>
        </div>
        
        <div class="form-group">
          <label for="dataPlantio">Data de Plantio:</label>
          <input type="date" id="dataPlantio" name="dataPlantio" required>
        </div>
        
        <div class="form-group">
          <label for="localizacao">Localização:</label>
          <input type="text" id="localizacao" name="localizacao" required>
        </div>
        
        <div class="form-group">
          <label for="altura">Altura (cm, somente números):</label>
          <input type="text" id="altura" name="altura" required>
        </div>
        
        <div class="form-group">
          <label for="observacoes">Observações:</label>
          <textarea id="observacoes" name="observacoes"></textarea>
        </div>
        
        <button type="submit">Cadastrar</button>
      </form>
    </section>
  </main>
  
  <footer>
    <p>Desenvolvido para avaliação técnica - Exemplo</p>
  </footer>
  
  <script>
    // Máscara simples: Ao digitar em altura, permitir apenas dígitos.
    const alturaInput = document.getElementById('altura');
    alturaInput.addEventListener('input', () => {
      alturaInput.value = alturaInput.value.replace(/\D/g,'');
    });
    
    const form = document.getElementById('formCadastro');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      // Validações extras
      const nome = document.getElementById('nome').value.trim();
      const especie = document.getElementById('especie').value.trim();
      const dataPlantio = document.getElementById('dataPlantio').value;
      const localizacao = document.getElementById('localizacao').value.trim();
      const altura = document.getElementById('altura').value.trim();
      const observacoes = document.getElementById('observacoes').value.trim();
      
      // Verifica obrigatoriedade
      if(!nome || !especie || !dataPlantio || !localizacao || !altura) {
        alert("Por favor, preencha todos os campos obrigatórios.");
        return;
      }
      
      // Verifica regex do nome (somente letras)
      const nomeRegex = /^[A-Za-zÀ-ú\s]+$/;
      if(!nomeRegex.test(nome)){
        alert("O nome da planta deve conter apenas letras.");
        return;
      }
      
      const novaPlanta = {
        nome,
        especie,
        dataPlantio,
        localizacao,
        altura: parseInt(altura, 10),
        observacoes
      };
      
      try {
        const response = await fetch('https://my-db-4ce9d-default-rtdb.firebaseio.com/plantas.json', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(novaPlanta)
        });
        
        if(response.ok) {
          alert('Planta cadastrada com sucesso!');
          form.reset();
        } else {
          alert('Erro ao cadastrar a planta!');
        }
      } catch (error) {
        console.error(error);
        alert('Falha na conexão com o banco de dados.');
      }
    });
  </script>
</body>
</html>
